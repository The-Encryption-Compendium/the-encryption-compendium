{% extends "dashboard_base.html" %}

{% block title %}New entry | {{ block.super }}{% endblock %}
{% block page_header %}
{% if edit is True %}
  Edit compendium entry
{% else %}
  New compendium entry
{% endif %}
{% endblock %}

{% block contents %}
{{ block.super }}
<form class="uk-panel uk-panel-box uk-form" method="POST">
  {% csrf_token %}

  <fieldset class="uk-margin-bottom">
    {% for field in form %}
    {% if field.name != "tags" %}
    <h2 class="uk-h2 uk-text-bold">{{ field.label }}</h2>
    {% if field.help_text %}
    <p>{{ field.help_text }}</p>
    {% endif %}
    {{ field }}
    {% endif %}
    {% endfor %}

    {# Display tags at the bottom of the form #}
    <h2 class="uk-h2 uk-text-bold">{{ form.tags.label }}</h2>
    <ul class="uk-grid uk-grid-small uk-grid-width-1-5" data-uk-sortable="">
      {% for checkbox in form.tags %}
      <li class="uk-grid-margin">
        <label for="id_tags_{{ forloop.counter0 }}">
          <span>{{ checkbox.tag }}</span> {{ checkbox.choice_label }}
        </label>
      </li>
      {% endfor %}
    </ul>
  </fieldset>

  <button id="entry-submit-button" class="uk-button" type="submit">
    {% if edit is True %}
    Edit entry
    {% else %}
    Add entry
    {% endif %}
  </button>
</form>
{% endblock %}

{% block css %}
{{ block.super }}
{% load static %}
<link rel="stylesheet" href="{% static 'codemirror/lib/codemirror.css' %}">
<link rel="stylesheet" href="{% static 'css/components/htmleditor.min.css' %}">
{% endblock %}

{% block javascripts %}
{{ block.super }}
{% load static %}
<script src="{% static 'codemirror/lib/codemirror.js' %}"></script>
<script src="{% static 'codemirror/mode/markdown/markdown.js' %}"></script>
<script src="{% static 'codemirror/addon/mode/overlay.js' %}"></script>
<script src="{% static 'codemirror/mode/xml/xml.js' %}"></script>
<script src="{% static 'codemirror/mode/gfm/gfm.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="{% static 'js/components/htmleditor.min.js' %}"></script>
{% endblock %}
